import{_ as q}from"./3RSYLLYj.js";import{g as L,j as z,o as r,c as n,a as e,d as h,t as v,n as A,m as b,k as p,B as T,l as x,b as k,w as O,T as E,q as j,r as u,p as B,A as D,_ as I,C as P}from"./COTtE1AH.js";import{u as C}from"./DMAxvBFp.js";const W={class:"min-h-screen bg-[#fdfbf7] py-10 font-hand relative overflow-hidden"},Z={class:"mx-auto max-w-5xl space-y-8 px-4 sm:px-6 lg:px-0 relative z-10"},F={class:"flex flex-col gap-4 rounded-xl border-4 border-black bg-white p-6 shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] hover:shadow-[10px_10px_0px_0px_rgba(0,0,0,1)] hover:-translate-y-1 transition-all duration-200"},G={class:"flex flex-wrap items-center justify-between gap-4"},H={class:"flex flex-wrap items-center gap-3 text-sm font-bold"},K={class:"inline-flex items-center gap-2 rounded-lg border-2 border-black bg-blue-100 px-3 py-1.5 shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]"},Q={class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},X={key:0,d:"m5 13 4 4L19 7"},Y={key:1,d:"M18 6 6 18M6 6l12 12"},ee={key:0,class:"flex flex-wrap gap-3 font-bold"},te={key:0,class:"flex items-center gap-2 rounded-lg border-2 border-black bg-red-100 px-4 py-2 text-red-700 shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]"},se={key:1,class:"flex items-center gap-2 rounded-lg border-2 border-black bg-blue-100 px-4 py-2 text-blue-700 shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]"},oe={class:"grid gap-8 lg:grid-cols-3"},le={class:"space-y-8 lg:col-span-2"},ae={class:"rounded-xl border-4 border-black bg-white p-6 shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] relative overflow-hidden group hover:-translate-y-0.5 transition-transform duration-200"},re={class:"flex items-center justify-between relative z-10"},ne={class:"relative inline-flex items-center cursor-pointer select-none"},de={class:"rounded-xl border-4 border-black bg-white p-6 shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] space-y-6"},ie={class:"space-y-5"},pe={class:"space-y-2 group"},ue={class:"space-y-2 group"},be={class:"rounded-xl border-4 border-black bg-white p-6 shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] space-y-4"},xe={class:"flex items-center justify-between"},ce={class:"relative inline-flex items-center cursor-pointer select-none"},ge={class:"p-4 bg-gray-50 border-2 border-black rounded-lg space-y-4 border-dashed"},fe={class:"space-y-2"},_e={class:"flex items-center gap-3"},ve={class:"space-y-2"},ye={class:"flex items-center gap-3"},we=["value"],me={key:0,class:"rounded-xl border-4 border-black bg-white p-6 shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] space-y-6"},he={class:"space-y-5"},ke={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},je={class:"space-y-2 group"},Ce={class:"space-y-2 group"},Te={class:"space-y-2 group"},Be={class:"space-y-8"},Le={class:"rounded-xl border-4 border-black bg-white p-6 shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] space-y-4 sticky top-6"},Oe=["disabled"],Me={key:0,class:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},Ne={key:1},Se={key:2},Ve=["disabled"],Je={key:0,class:"fixed top-6 right-6 z-[100] flex items-center gap-3 rounded-lg border-4 border-black bg-green-100 px-6 py-4 text-green-900 shadow-[6px_6px_0px_0px_rgba(0,0,0,1)]"},Ue={class:"font-bold text-lg"},Re=L({__name:"config",setup(M){const y=D(),c=j(()=>{if(console.log("config-is-online"),typeof window<"u")return"/api";const l=y.public?.apiBase,t=typeof window<"u"?window.__SL_API_BASE__:"";return(l||t||"/api").replace(/\/$/,"")}),w=l=>`${c.value}${l}`,d=u(!1),i=u(!1),a=u(""),N=u(""),g=u(""),m=u(!1),f=u(null),S=l=>{g.value=l,m.value=!0,f.value&&clearTimeout(f.value),f.value=window.setTimeout(()=>{m.value=!1,g.value="",f.value=null},2800)},s=B({enabled:!0,dingTalk:{webhook:"",secret:""},rateLimit:{enabled:!0,maxRequests:10},auth:{username:"",password:"",token:""}}),_=B({enabled:!0,dingTalk:{webhook:"",secret:""},rateLimit:{enabled:!0,maxRequests:10},auth:{username:"",password:"",token:""}}),V=j(()=>JSON.stringify(s)!==JSON.stringify(_)),J=()=>{if(a.value="",!s.dingTalk.webhook.trim())return a.value="é’‰é’‰ webhook å¿…å¡«",!1;if(s.rateLimit.maxRequests<=0)return a.value="é¢‘æŽ§é˜ˆå€¼éœ€ä¸ºæ­£æ•´æ•°",!1;if(s.auth){if(!s.auth.username?.trim())return a.value="ç”¨æˆ·åä¸èƒ½ä¸ºç©º",!1;if(!s.auth.password?.trim())return a.value="å¯†ç ä¸èƒ½ä¸ºç©º",!1;if(!s.auth.token?.trim())return a.value="Token ä¸èƒ½ä¸ºç©º",!1}return!0},U=async()=>{d.value=!0,a.value="";try{const l=await fetch(w("/config"),{credentials:"include"});if(l.status===401){const o=C("auth");o.value=null,window.location.href="/login";return}if(!l.ok)throw new Error("load config failed");const t=await l.json();Object.assign(s,t),Object.assign(_,JSON.parse(JSON.stringify(t)))}catch{a.value="åŠ è½½é…ç½®å¤±è´¥ï¼Œè¯·ç¨åŽå†è¯•"}finally{d.value=!1}},R=()=>{Object.assign(s,JSON.parse(JSON.stringify(_))),a.value=""},$=async()=>{if(J()){i.value=!0,a.value="";try{const l=await fetch(w("/config"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s),credentials:"include"});if(l.status===401){const o=C("auth");o.value=null,window.location.href="/login";return}if(!l.ok)throw new Error("save failed");const t=await l.json();Object.assign(_,JSON.parse(JSON.stringify(t))),S("ä¿å­˜æˆåŠŸ")}catch{a.value="ä¿å­˜å¤±è´¥ï¼Œè¯·ç¨åŽå†è¯•"}finally{i.value=!1}}};return z(()=>{U()}),(l,t)=>(r(),n("div",W,[t[36]||(t[36]=e("div",{class:"absolute inset-0 z-0 opacity-10",style:{"background-image":"radial-gradient(#000 1px, transparent 1px)","background-size":"20px 20px"}},null,-1)),t[37]||(t[37]=e("div",{class:"absolute top-20 right-20 w-32 h-32 border-4 border-black rounded-full opacity-10 pointer-events-none hidden lg:block"},null,-1)),t[38]||(t[38]=e("div",{class:"absolute bottom-40 left-10 w-20 h-20 border-4 border-black transform rotate-45 opacity-10 pointer-events-none hidden lg:block"},null,-1)),e("div",Z,[e("div",F,[e("div",G,[t[9]||(t[9]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 tracking-wide"},"æœåŠ¡é…ç½®"),e("p",{class:"text-lg text-gray-600 font-bold mt-1"},"é…ç½®é¢æ¿")],-1)),e("div",H,[e("span",K,[t[8]||(t[8]=e("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M3 5h18"}),e("path",{d:"M7 12h10"}),e("path",{d:"M5 19h14"})],-1)),h(" API åŸºç¡€åœ°å€: "+v(c.value),1)]),e("span",{class:A(["inline-flex items-center gap-2 rounded-lg border-2 border-black px-3 py-1.5 shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]",s.enabled?"bg-green-100 text-green-800":"bg-gray-200 text-gray-600"])},[(r(),n("svg",Q,[s.enabled?(r(),n("path",X)):(r(),n("path",Y))])),h(" "+v(s.enabled?"å·²å¯ç”¨":"å·²ç¦ç”¨"),1)],2)])]),a.value||N.value||d.value?(r(),n("div",ee,[a.value?(r(),n("div",te,[t[10]||(t[10]=e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M12 9v4m0 4h.01"}),e("path",{d:"M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.7 3.86a2 2 0 0 0-3.42 0Z"})],-1)),e("span",null,v(a.value),1)])):b("",!0),d.value?(r(),n("div",se,[...t[11]||(t[11]=[e("svg",{class:"h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})],-1),e("span",null,"åŠ è½½ä¸­...",-1)])])):b("",!0)])):b("",!0)]),e("div",oe,[e("div",le,[e("div",ae,[t[15]||(t[15]=e("div",{class:"absolute -right-6 -top-6 w-20 h-20 bg-yellow-200 rounded-full border-2 border-black opacity-50 group-hover:scale-110 transition-transform"},null,-1)),e("div",re,[t[14]||(t[14]=e("div",null,[e("p",{class:"text-xl font-bold text-gray-900"},"ç³»ç»ŸçŠ¶æ€"),e("p",{class:"text-base text-gray-600 font-bold mt-1"},"æŽ¥æ”¶åé¦ˆ?")],-1)),e("label",ne,[p(e("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=o=>s.enabled=o),class:"sr-only peer"},null,512),[[T,s.enabled]]),t[12]||(t[12]=e("div",{class:"w-14 h-8 bg-gray-200 peer-focus:outline-none border-2 border-black rounded-full peer peer-checked:bg-green-400 transition-colors shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]"},null,-1)),t[13]||(t[13]=e("div",{class:"absolute left-1 top-1 bg-white border-2 border-black rounded-full h-6 w-6 transition-all peer-checked:translate-x-6"},null,-1))])])]),e("div",de,[t[18]||(t[18]=e("div",{class:"flex items-center justify-between border-b-2 border-dashed border-gray-200 pb-4"},[e("div",null,[e("p",{class:"text-xl font-bold text-gray-900"},"é’‰é’‰é›†æˆ"),e("p",{class:"text-base text-gray-600 font-bold mt-1"},"é…ç½®æ‚¨çš„æœºå™¨äºº")]),e("span",{class:"rounded-lg border-2 border-black bg-blue-100 px-3 py-1 text-xs font-bold text-blue-900 shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]"},"éœ€è¦ Webhook")],-1)),e("div",ie,[e("div",pe,[t[16]||(t[16]=e("label",{class:"text-base font-bold text-gray-800 ml-1 block group-hover:-translate-y-0.5 transition-transform"},"Webhook URL *",-1)),p(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>s.dingTalk.webhook=o),class:"w-full rounded-lg border-2 border-black px-4 py-3 text-base text-gray-900 placeholder-gray-400 focus:outline-none focus:shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all bg-gray-50 focus:bg-white",placeholder:"https://oapi.dingtalk.com/robot/send?access_token=..."},null,512),[[x,s.dingTalk.webhook]])]),e("div",ue,[t[17]||(t[17]=e("label",{class:"text-base font-bold text-gray-800 ml-1 block group-hover:-translate-y-0.5 transition-transform"},"å¯†é’¥ (å¯é€‰)",-1)),p(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.dingTalk.secret=o),class:"w-full rounded-lg border-2 border-black px-4 py-3 text-base text-gray-900 placeholder-gray-400 focus:outline-none focus:shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all bg-gray-50 focus:bg-white",placeholder:"Leave empty if signing is disabled"},null,512),[[x,s.dingTalk.secret]])])])]),e("div",be,[e("div",xe,[t[21]||(t[21]=e("div",null,[e("p",{class:"text-xl font-bold text-gray-900"},"é¢‘çŽ‡é™åˆ¶"),e("p",{class:"text-base text-gray-600 font-bold mt-1"},"é˜²æ­¢æ»¥ç”¨")],-1)),e("label",ce,[p(e("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=o=>s.rateLimit.enabled=o),class:"sr-only peer"},null,512),[[T,s.rateLimit.enabled]]),t[19]||(t[19]=e("div",{class:"w-12 h-7 bg-gray-200 peer-focus:outline-none border-2 border-black rounded-full peer peer-checked:bg-blue-400 transition-colors shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]"},null,-1)),t[20]||(t[20]=e("div",{class:"absolute left-1 top-1 bg-white border-2 border-black rounded-full h-5 w-5 transition-all peer-checked:translate-x-5"},null,-1))])]),e("div",ge,[e("div",fe,[t[23]||(t[23]=e("label",{class:"text-sm font-bold text-gray-800"},"æœ€å¤§è¯·æ±‚æ•°",-1)),e("div",_e,[p(e("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=o=>s.rateLimit.maxRequests=o),class:"w-full md:w-48 rounded-lg border-2 border-black px-3 py-2 text-gray-900 focus:outline-none focus:shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] transition-all",min:"1"},null,512),[[x,s.rateLimit.maxRequests,void 0,{number:!0}]]),t[22]||(t[22]=e("span",{class:"text-sm font-bold text-gray-500"},"æ¯æ—¶é—´çª—å£",-1))])]),e("div",ve,[t[25]||(t[25]=e("label",{class:"text-sm font-bold text-gray-800"},"æ—¶é—´çª—å£ (åˆ†é’Ÿ)",-1)),e("div",ye,[e("input",{type:"number",value:s.rateLimit.windowMinutes,class:"w-full md:w-48 rounded-lg border-2 border-gray-300 px-3 py-2 text-gray-500 bg-gray-100 cursor-not-allowed font-bold",readonly:""},null,8,we),t[24]||(t[24]=e("span",{class:"text-sm font-bold text-gray-400"},"å›ºå®š",-1))])])])]),s.auth?(r(),n("div",me,[t[30]||(t[30]=e("div",{class:"flex items-center justify-between"},[e("div",null,[e("p",{class:"text-xl font-bold text-gray-900"},"å®‰å…¨è®¾ç½®"),e("p",{class:"text-base text-gray-600 font-bold mt-1"},"ç®¡ç†å‘˜å‡­æ®")]),e("span",{class:"rounded-lg border-2 border-black bg-yellow-100 px-3 py-1 text-xs font-bold text-yellow-900 shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]"},"éœ€è¦é‡æ–°ç™»å½•")],-1)),e("div",he,[e("div",ke,[e("div",je,[t[26]||(t[26]=e("label",{class:"text-base font-bold text-gray-800 ml-1"},"ç”¨æˆ·å *",-1)),p(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>s.auth.username=o),class:"w-full rounded-lg border-2 border-black px-4 py-3 text-base focus:outline-none focus:shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all"},null,512),[[x,s.auth.username]])]),e("div",Ce,[t[27]||(t[27]=e("label",{class:"text-base font-bold text-gray-800 ml-1"},"å¯†ç  *",-1)),p(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>s.auth.password=o),type:"text",class:"w-full rounded-lg border-2 border-black px-4 py-3 text-base focus:outline-none focus:shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all"},null,512),[[x,s.auth.password]])])]),e("div",Te,[t[28]||(t[28]=e("label",{class:"text-base font-bold text-gray-800 ml-1"},"è®¤è¯ä»¤ç‰Œ *",-1)),p(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>s.auth.token=o),class:"w-full rounded-lg border-2 border-black px-4 py-3 text-base text-gray-600 focus:outline-none focus:shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all"},null,512),[[x,s.auth.token]]),t[29]||(t[29]=e("p",{class:"text-sm font-bold text-gray-500 mt-1"},"âš ï¸ æ›´æ”¹æ­¤é€‰é¡¹ä¼šä½¿å½“å‰ä¼šè¯å¤±æ•ˆã€‚",-1))])])])):b("",!0)]),e("div",Be,[e("div",Le,[t[32]||(t[32]=e("p",{class:"text-xl font-bold text-gray-900 border-b-2 border-black pb-2"},"æ“ä½œ",-1)),e("button",{class:"flex w-full items-center justify-center gap-2 rounded-lg border-2 border-black bg-blue-500 px-6 py-3 text-lg font-bold text-white shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all hover:bg-blue-400 hover:-translate-y-0.5 active:translate-y-0 active:translate-x-0.5 active:shadow-none disabled:opacity-50 disabled:cursor-not-allowed",disabled:i.value||d.value||!V.value,onClick:$},[i.value?(r(),n("svg",Me,[...t[31]||(t[31]=[e("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"},null,-1)])])):b("",!0),i.value?(r(),n("span",Ne,"ä¿å­˜ä¸­...")):(r(),n("span",Se,"ä¿å­˜æ›´æ”¹"))],8,Oe),e("button",{class:"flex w-full items-center justify-center gap-2 rounded-lg border-2 border-black bg-white px-6 py-3 text-lg font-bold text-gray-800 shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all hover:bg-gray-50 hover:-translate-y-0.5 active:translate-y-0 active:translate-x-0.5 active:shadow-none disabled:opacity-50",disabled:i.value||d.value,onClick:R}," é‡ç½® ",8,Ve),t[33]||(t[33]=e("div",{class:"p-3 bg-blue-50 border-2 border-black rounded-lg mt-4"},[e("p",{class:"text-xs font-bold text-blue-800 leading-relaxed text-center"}," æ›´æ”¹å°†åœ¨ä¿å­˜åŽç«‹å³ç”Ÿæ•ˆã€‚ ")],-1))]),t[34]||(t[34]=e("div",{class:"rounded-xl border-4 border-black border-dashed bg-transparent p-6 text-sm font-bold text-gray-600"},[e("p",{class:"text-lg text-black mb-2"},"ðŸ’¡ ä½¿ç”¨æŠ€å·§"),e("ul",{class:"list-disc space-y-2 pl-4 marker:text-black"},[e("li",null,"Webhooks å¿…é¡»ä»¥ https:// å¼€å¤´"),e("li",null,"å¯†é’¥ä»…ç”¨äºŽç­¾åè¯·æ±‚"),e("li",null,"é¢‘çŽ‡é™åˆ¶æ¯å°æ—¶é‡ç½®"),e("li",null,"è¯·å¦¥å–„ä¿ç®¡æ‚¨çš„ä»¤ç‰Œï¼")])],-1))])])]),k(E,{name:"toast-pop"},{default:O(()=>[m.value&&g.value?(r(),n("div",Je,[t[35]||(t[35]=e("div",{class:"bg-green-500 rounded-full p-1 border-2 border-black text-white"},[e("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"m5 13 4 4L19 7"})])],-1)),e("span",Ue,v(g.value),1)])):b("",!0)]),_:1})]))}}),$e=Object.assign(I(Re,[["__scopeId","data-v-157d24d5"]]),{__name:"Config"}),qe={key:0},ze={key:1,class:"flex items-center justify-center min-h-screen"},Ae={class:"text-center"},Pe=L({__name:"config",setup(M){const y=C("auth"),c=j(()=>!!y.value);return(w,d)=>{const i=q;return P(c)?(r(),n("div",qe,[k($e)])):(r(),n("div",ze,[e("div",Ae,[d[1]||(d[1]=e("p",{class:"text-lg font-bold"},"æ‚¨æ²¡æœ‰æƒé™è®¿é—®æ­¤é¡µé¢",-1)),k(i,{to:"/login?redirect=config",class:"mt-4 inline-block bg-blue-500 text-white px-4 py-2 rounded border-2 border-black shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]"},{default:O(()=>[...d[0]||(d[0]=[h(" è¯·ç™»å½• ",-1)])]),_:1})])]))}}});export{Pe as default};
